{% extends "base.html" %}
{% block content %}
<style>
  body {
    background-color: #030b1a;
    color: #f9fafb;
    font-family: "Inter", sans-serif;
  }
   .custom-table {
  width: 100%;
  border-collapse: collapse;
  font-size: 0.9rem;
  color: #f9fafb;
  background-color: #1f2937;
}

.custom-table thead {
  background-color: #273549;
  position: sticky;
  top: 0;
  z-index: 2;
  color: #b5bcc7;
}

.custom-table th, .custom-table td {
  padding: 12px 10px;
  border-bottom: 1px solid #374151;
}

.custom-table tbody tr:nth-child(even) {
  background-color: #273549;
}

.custom-table tbody tr:nth-child(odd) {
  background-color: #1f2937;
}

.custom-table tbody tr:hover {
  background-color: #006effff !important;
  color: #f9fafb;
  transition: 0.3s;
}

.table-responsive::-webkit-scrollbar {
  width: 8px;
}
.table-responsive::-webkit-scrollbar-track {
  background: #1f2937;
}
.table-responsive::-webkit-scrollbar-thumb {
  background-color: #006effff;
  border-radius: 10px;
}
  </style>
<div class="container py-4" style="color: #f9fafb;">

  <!-- Başlıq və Əlavə Düymələr -->
  <div class="d-flex align-items-center mb-3 justify-content-between">
    <div class="d-flex align-items-center gap-2">
      <i class="fa-solid fa-map-location-dot fa-2x text-primary"></i>
      <h4 class="mb-0">Bölgələr</h4>
    </div>
    <div class="d-flex gap-2">
      <button type="button" class="btn btn-primary d-flex align-items-center gap-2" data-bs-toggle="modal" data-bs-target="#addRegionModal">
        <i class="bi bi-plus-circle"></i> Bölgə Əlavə et
      </button>
      <button type="button" class="btn btn-success d-flex align-items-center gap-2" data-bs-toggle="modal" data-bs-target="#addHospitalModal">
        <i class="bi bi-plus-circle"></i> Klinika/Xəstəxana Əlavə et
      </button>
    </div>
  </div>

  <!-- Dashboard Kartları -->
  <div class="row g-4 mt-4">
    {% comment %} Kart stili: shadow, rounded, hover efekti, dark color {% endcomment %}
    <div class="col-md-2">
      <div class="card shadow-sm text-center p-3" style="background-color: #273549; border-radius: 12px;">
        <h4 class="fw-bold">{{ region_count }}</h4>
        <h6 class="text-muted">Ümumi sayı</h6>
      </div>
    </div>
    <div class="col-md-2">
      <div class="card shadow-sm text-center p-3" style="background-color: #5b70f3; border-radius: 12px;">
        <h4 class="fw-bold">{{ diger_sayi }}</h4>
        <h6 class="text-muted">Region Bölgəsi sayı</h6>
      </div>
    </div>
    <div class="col-md-2">
      <div class="card shadow-sm text-center p-3" style="background-color: #55e0a3; border-radius: 12px;">
        <h4 class="fw-bold">{{ baki_sayi }}</h4>
        <h6 class="text-muted">Bakı bölgəsi sayı</h6>
      </div>
    </div>
    <div class="col-md-2">
      <div class="card shadow-sm text-center p-3" style="background-color: #4850b9; border-radius: 12px;">
        <h4 class="fw-bold">{{ doctor_count }}</h4>
        <h6 class="text-muted">Həkim sayı</h6>
      </div>
    </div>
    <div class="col-md-2">
      <div class="card shadow-sm text-center p-3" style="background-color: #e9042e; border-radius: 12px;">
        <h4 class="fw-bold">{{ city_count }}</h4>
        <h6 class="text-muted">Şəhər sayı</h6>
      </div>
    </div>
    <div class="col-md-2">
      <div class="card shadow-sm text-center p-3" style="background-color: #fbbf24; color: #1f2937; border-radius: 12px;">
        <h4 class="fw-bold">{{ hospital_count }}</h4>
        <h6 class="text-muted">Xəstəxana sayı</h6>
      </div>
    </div>
  </div>

  <!-- Table -->
<div class="table-responsive mt-4" style="max-height: 500px; overflow-y: auto;">
  <table class="custom-table align-middle text-center">
    <thead>
      <tr>
        <th>#</th>
        <th>Region Adı</th>
        <th>Region Növü</th>
        <th>Həkim Sayı</th>
        <th>Şəhər Sayı</th>
        <th>Klinika Sayı</th>
      </tr>
    </thead>
    <tbody>
      {% for region in regions %}
      <tr>
        <th>{{ forloop.counter }}</th>
        <td><strong>{{ region.region_name }}</strong></td>
        <td>
          {% if region.get_region_type_display == "Bakı" %}
            <span class="badge bg-success">Bakı</span>
          {% else %}
            <span class="badge bg-primary">Digər</span>
          {% endif %}
        </td>
        <td>
          {% if region.doctors.count == 0 %}
            <span class="badge bg-danger fs-6">0</span>
          {% else %}
            <span class="badge bg-info fs-6">{{ region.doctors.count }}</span>
          {% endif %}
        </td>
        <td>
          {% if region.city_count == 0 %}
            <span class="badge bg-danger fs-6">0</span>
          {% else %}
            <span class="badge bg-info fs-6">{{ region.city_count }}</span>
          {% endif %}
        </td>
        <td>
          {% if region.hospital_count == 0 %}
            <span class="badge bg-danger fs-6">0</span>
          {% else %}
            <span class="badge bg-warning text-dark fs-6">{{ region.hospital_count }}</span>
          {% endif %}
        </td>
      </tr>
      {% empty %}
      <tr>
        <td colspan="6" class="text-center">Region tapılmadı.</td>
      </tr>
      {% endfor %}
    </tbody>
  </table>
</div>
  </div>
</div>

<!-- Modallar: Bölgə & Xəstəxana -->
<div class="modal fade" id="addRegionModal" tabindex="-1">
  <div class="modal-dialog">
    <form method="POST" action="{% url 'add-region' %}" class="modal-content" style="background-color: #1f2937; color: #f9fafb;">
      {% csrf_token %}
      <div class="modal-header">
        <h5 class="modal-title">➕ Yeni Bölgə Əlavə et</h5>
        <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
      </div>
      <div class="modal-body">
        <div class="mb-3">
          <label for="region_name" class="form-label">Bölgənin Adı</label>
          <input type="text" class="form-control" id="region_name" name="region_name" required style="background-color: #273549; color: #f9fafb; border: none;">
        </div>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">İmtina</button>
        <button type="submit" class="btn btn-primary">Əlavə et</button>
      </div>
    </form>
  </div>
</div>

<div class="modal fade" id="addHospitalModal" tabindex="-1">
  <div class="modal-dialog">
    <form method="POST" action="{% url 'add-hospital' %}" class="modal-content" style="background-color: #1f2937; color: #f9fafb;">
      {% csrf_token %}
      <div class="modal-header">
        <h5 class="modal-title">➕ Yeni Klinikaya Əlavə Et</h5>
        <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
      </div>
      <div class="modal-body">
        <div class="mb-3">
          <label for="hospital_name" class="form-label">Klinika Adı</label>
          <input type="text" class="form-control" id="hospital_name" name="hospital_name" required style="background-color: #273549; color: #f9fafb; border: none;">
        </div>
        <div class="mb-3">
          <label for="region_net" class="form-label">Bölgə Seçin</label>
          <select class="form-select" id="region_net" name="region_net" required style="background-color: #273549; color: #f9fafb; border: none;">
            <option selected disabled>Seçin...</option>
            {% for r in regions %}
              <option value="{{ r.id }}">{{ r.region_name }}</option>
            {% endfor %}
          </select>
        </div>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">İmtina</button>
        <button type="submit" class="btn btn-success"><i class="bi bi-plus-circle me-1"></i> Əlavə Et</button>
      </div>
    </form>
  </div>
</div>

{% endblock content %}